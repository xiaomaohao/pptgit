<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Tabulation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Yangyong Ye" />
    <script src="libs/header-attrs-2.5.3/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/rladies.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/lucy-fonts.css" rel="stylesheet" />
    <link href="libs/tile-view-0.2.4/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.4/tile-view.js"></script>
    <link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
    <script src="libs/tabwid-1.0.0/tabwid.js"></script>
    <script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
    <script src="libs/jquery-1.12.4/jquery.min.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.16/datatables.js"></script>
    <link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="my_css.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data Tabulation
## 3rd class
### Yangyong Ye
### 2020/11/20 (updated: 2020-11-24)

---







# Data Tabulation

- Table Type

  - frequency table

  - cross table
  
  - summary table
  
  - test table(T, chi, anovo)
  
  - regression table





---

# Tabulation packages

- Table creation: .red[**base**], sjmics, sjplot, table1, .red[**gtsummary**], .red[**rstatix**]

- Table formatting: gt, formattable, kable, [kableExtra](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html#Overview), .red[**flextable**]

- Responsive table: [reactable](https://glin.github.io/reactable/index.html), .red[**DT**]

.footnote[**Bold** packages will be taught in class]


---
class: reverse
# base package

count: false
 

.panel1-basetable-auto[

```r
*head(mtcars)
```
]
 
.panel2-basetable-auto[

```
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```
]

---
count: false
 

.panel1-basetable-auto[

```r
head(mtcars)
*table(mtcars$cyl)
```
]
 
.panel2-basetable-auto[

```
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```

```

 4  6  8 
11  7 14 
```
]

---
count: false
 

.panel1-basetable-auto[

```r
head(mtcars)
table(mtcars$cyl)
*table(mtcars$cyl,mtcars$vs)
```
]
 
.panel2-basetable-auto[

```
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```

```

 4  6  8 
11  7 14 
```

```
   
     0  1
  4  1 10
  6  3  4
  8 14  0
```
]

---
count: false
 

.panel1-basetable-auto[

```r
head(mtcars)
table(mtcars$cyl)
table(mtcars$cyl,mtcars$vs)
*summary(mtcars$mpg)
```
]
 
.panel2-basetable-auto[

```
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```

```

 4  6  8 
11  7 14 
```

```
   
     0  1
  4  1 10
  6  3  4
  8 14  0
```

```
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10.40   15.43   19.20   20.09   22.80   33.90 
```
]

&lt;style&gt;
.panel1-basetable-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-basetable-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-basetable-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: middle, inverse

# [rstatix](https://rpkgs.datanovia.com/rstatix/index.html)

- ## get_summary_stats()

- ## freq_table()

---
class: inverse

count: false
 

.panel1-rstatixtable-auto[

```r
*library(rstatix)
```
]
 
.panel2-rstatixtable-auto[

]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
*data("ToothGrowth")
```
]
 
.panel2-rstatixtable-auto[

]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
*ToothGrowth
```
]
 
.panel2-rstatixtable-auto[

```
    len supp dose
1   4.2   VC  0.5
2  11.5   VC  0.5
3   7.3   VC  0.5
4   5.8   VC  0.5
5   6.4   VC  0.5
6  10.0   VC  0.5
7  11.2   VC  0.5
8  11.2   VC  0.5
9   5.2   VC  0.5
10  7.0   VC  0.5
11 16.5   VC  1.0
12 16.5   VC  1.0
13 15.2   VC  1.0
14 17.3   VC  1.0
15 22.5   VC  1.0
16 17.3   VC  1.0
17 13.6   VC  1.0
18 14.5   VC  1.0
19 18.8   VC  1.0
20 15.5   VC  1.0
21 23.6   VC  2.0
22 18.5   VC  2.0
23 33.9   VC  2.0
24 25.5   VC  2.0
25 26.4   VC  2.0
26 32.5   VC  2.0
27 26.7   VC  2.0
28 21.5   VC  2.0
29 23.3   VC  2.0
30 29.5   VC  2.0
31 15.2   OJ  0.5
32 21.5   OJ  0.5
33 17.6   OJ  0.5
34  9.7   OJ  0.5
35 14.5   OJ  0.5
36 10.0   OJ  0.5
37  8.2   OJ  0.5
38  9.4   OJ  0.5
39 16.5   OJ  0.5
40  9.7   OJ  0.5
41 19.7   OJ  1.0
42 23.3   OJ  1.0
43 23.6   OJ  1.0
44 26.4   OJ  1.0
45 20.0   OJ  1.0
46 25.2   OJ  1.0
47 25.8   OJ  1.0
48 21.2   OJ  1.0
49 14.5   OJ  1.0
50 27.3   OJ  1.0
51 25.5   OJ  2.0
52 26.4   OJ  2.0
53 22.4   OJ  2.0
54 24.5   OJ  2.0
55 24.8   OJ  2.0
56 30.9   OJ  2.0
57 26.4   OJ  2.0
58 27.3   OJ  2.0
59 29.4   OJ  2.0
60 23.0   OJ  2.0
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
* get_summary_stats(len)
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
*ToothGrowth
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
    len supp dose
1   4.2   VC  0.5
2  11.5   VC  0.5
3   7.3   VC  0.5
4   5.8   VC  0.5
5   6.4   VC  0.5
6  10.0   VC  0.5
7  11.2   VC  0.5
8  11.2   VC  0.5
9   5.2   VC  0.5
10  7.0   VC  0.5
11 16.5   VC  1.0
12 16.5   VC  1.0
13 15.2   VC  1.0
14 17.3   VC  1.0
15 22.5   VC  1.0
16 17.3   VC  1.0
17 13.6   VC  1.0
18 14.5   VC  1.0
19 18.8   VC  1.0
20 15.5   VC  1.0
21 23.6   VC  2.0
22 18.5   VC  2.0
23 33.9   VC  2.0
24 25.5   VC  2.0
25 26.4   VC  2.0
26 32.5   VC  2.0
27 26.7   VC  2.0
28 21.5   VC  2.0
29 23.3   VC  2.0
30 29.5   VC  2.0
31 15.2   OJ  0.5
32 21.5   OJ  0.5
33 17.6   OJ  0.5
34  9.7   OJ  0.5
35 14.5   OJ  0.5
36 10.0   OJ  0.5
37  8.2   OJ  0.5
38  9.4   OJ  0.5
39 16.5   OJ  0.5
40  9.7   OJ  0.5
41 19.7   OJ  1.0
42 23.3   OJ  1.0
43 23.6   OJ  1.0
44 26.4   OJ  1.0
45 20.0   OJ  1.0
46 25.2   OJ  1.0
47 25.8   OJ  1.0
48 21.2   OJ  1.0
49 14.5   OJ  1.0
50 27.3   OJ  1.0
51 25.5   OJ  2.0
52 26.4   OJ  2.0
53 22.4   OJ  2.0
54 24.5   OJ  2.0
55 24.8   OJ  2.0
56 30.9   OJ  2.0
57 26.4   OJ  2.0
58 27.3   OJ  2.0
59 29.4   OJ  2.0
60 23.0   OJ  2.0
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
* get_summary_stats(len, type = "robust")
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
*ToothGrowth
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
    len supp dose
1   4.2   VC  0.5
2  11.5   VC  0.5
3   7.3   VC  0.5
4   5.8   VC  0.5
5   6.4   VC  0.5
6  10.0   VC  0.5
7  11.2   VC  0.5
8  11.2   VC  0.5
9   5.2   VC  0.5
10  7.0   VC  0.5
11 16.5   VC  1.0
12 16.5   VC  1.0
13 15.2   VC  1.0
14 17.3   VC  1.0
15 22.5   VC  1.0
16 17.3   VC  1.0
17 13.6   VC  1.0
18 14.5   VC  1.0
19 18.8   VC  1.0
20 15.5   VC  1.0
21 23.6   VC  2.0
22 18.5   VC  2.0
23 33.9   VC  2.0
24 25.5   VC  2.0
25 26.4   VC  2.0
26 32.5   VC  2.0
27 26.7   VC  2.0
28 21.5   VC  2.0
29 23.3   VC  2.0
30 29.5   VC  2.0
31 15.2   OJ  0.5
32 21.5   OJ  0.5
33 17.6   OJ  0.5
34  9.7   OJ  0.5
35 14.5   OJ  0.5
36 10.0   OJ  0.5
37  8.2   OJ  0.5
38  9.4   OJ  0.5
39 16.5   OJ  0.5
40  9.7   OJ  0.5
41 19.7   OJ  1.0
42 23.3   OJ  1.0
43 23.6   OJ  1.0
44 26.4   OJ  1.0
45 20.0   OJ  1.0
46 25.2   OJ  1.0
47 25.8   OJ  1.0
48 21.2   OJ  1.0
49 14.5   OJ  1.0
50 27.3   OJ  1.0
51 25.5   OJ  2.0
52 26.4   OJ  2.0
53 22.4   OJ  2.0
54 24.5   OJ  2.0
55 24.8   OJ  2.0
56 30.9   OJ  2.0
57 26.4   OJ  2.0
58 27.3   OJ  2.0
59 29.4   OJ  2.0
60 23.0   OJ  2.0
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
* get_summary_stats(len, type = "five_number")
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "five_number")
*ToothGrowth
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```

```
    len supp dose
1   4.2   VC  0.5
2  11.5   VC  0.5
3   7.3   VC  0.5
4   5.8   VC  0.5
5   6.4   VC  0.5
6  10.0   VC  0.5
7  11.2   VC  0.5
8  11.2   VC  0.5
9   5.2   VC  0.5
10  7.0   VC  0.5
11 16.5   VC  1.0
12 16.5   VC  1.0
13 15.2   VC  1.0
14 17.3   VC  1.0
15 22.5   VC  1.0
16 17.3   VC  1.0
17 13.6   VC  1.0
18 14.5   VC  1.0
19 18.8   VC  1.0
20 15.5   VC  1.0
21 23.6   VC  2.0
22 18.5   VC  2.0
23 33.9   VC  2.0
24 25.5   VC  2.0
25 26.4   VC  2.0
26 32.5   VC  2.0
27 26.7   VC  2.0
28 21.5   VC  2.0
29 23.3   VC  2.0
30 29.5   VC  2.0
31 15.2   OJ  0.5
32 21.5   OJ  0.5
33 17.6   OJ  0.5
34  9.7   OJ  0.5
35 14.5   OJ  0.5
36 10.0   OJ  0.5
37  8.2   OJ  0.5
38  9.4   OJ  0.5
39 16.5   OJ  0.5
40  9.7   OJ  0.5
41 19.7   OJ  1.0
42 23.3   OJ  1.0
43 23.6   OJ  1.0
44 26.4   OJ  1.0
45 20.0   OJ  1.0
46 25.2   OJ  1.0
47 25.8   OJ  1.0
48 21.2   OJ  1.0
49 14.5   OJ  1.0
50 27.3   OJ  1.0
51 25.5   OJ  2.0
52 26.4   OJ  2.0
53 22.4   OJ  2.0
54 24.5   OJ  2.0
55 24.8   OJ  2.0
56 30.9   OJ  2.0
57 26.4   OJ  2.0
58 27.3   OJ  2.0
59 29.4   OJ  2.0
60 23.0   OJ  2.0
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "five_number")
ToothGrowth %&gt;%
* get_summary_stats(len, type = "mean_sd")
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```

```
# A tibble: 1 x 4
  variable     n  mean    sd
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60  18.8  7.65
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "five_number")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "mean_sd")
*ToothGrowth
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```

```
# A tibble: 1 x 4
  variable     n  mean    sd
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60  18.8  7.65
```

```
    len supp dose
1   4.2   VC  0.5
2  11.5   VC  0.5
3   7.3   VC  0.5
4   5.8   VC  0.5
5   6.4   VC  0.5
6  10.0   VC  0.5
7  11.2   VC  0.5
8  11.2   VC  0.5
9   5.2   VC  0.5
10  7.0   VC  0.5
11 16.5   VC  1.0
12 16.5   VC  1.0
13 15.2   VC  1.0
14 17.3   VC  1.0
15 22.5   VC  1.0
16 17.3   VC  1.0
17 13.6   VC  1.0
18 14.5   VC  1.0
19 18.8   VC  1.0
20 15.5   VC  1.0
21 23.6   VC  2.0
22 18.5   VC  2.0
23 33.9   VC  2.0
24 25.5   VC  2.0
25 26.4   VC  2.0
26 32.5   VC  2.0
27 26.7   VC  2.0
28 21.5   VC  2.0
29 23.3   VC  2.0
30 29.5   VC  2.0
31 15.2   OJ  0.5
32 21.5   OJ  0.5
33 17.6   OJ  0.5
34  9.7   OJ  0.5
35 14.5   OJ  0.5
36 10.0   OJ  0.5
37  8.2   OJ  0.5
38  9.4   OJ  0.5
39 16.5   OJ  0.5
40  9.7   OJ  0.5
41 19.7   OJ  1.0
42 23.3   OJ  1.0
43 23.6   OJ  1.0
44 26.4   OJ  1.0
45 20.0   OJ  1.0
46 25.2   OJ  1.0
47 25.8   OJ  1.0
48 21.2   OJ  1.0
49 14.5   OJ  1.0
50 27.3   OJ  1.0
51 25.5   OJ  2.0
52 26.4   OJ  2.0
53 22.4   OJ  2.0
54 24.5   OJ  2.0
55 24.8   OJ  2.0
56 30.9   OJ  2.0
57 26.4   OJ  2.0
58 27.3   OJ  2.0
59 29.4   OJ  2.0
60 23.0   OJ  2.0
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "five_number")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "mean_sd")
ToothGrowth %&gt;%
* get_summary_stats(len,dose, show = c("mean","sd", "median","iqr"))
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```

```
# A tibble: 1 x 4
  variable     n  mean    sd
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60  18.8  7.65
```

```
# A tibble: 2 x 6
  variable     n  mean    sd median   iqr
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 dose        60  1.17 0.629    1     1.5
2 len         60 18.8  7.65    19.2  12.2
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "five_number")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "mean_sd")
ToothGrowth %&gt;%
  get_summary_stats(len,dose, show = c("mean","sd", "median","iqr"))

*ToothGrowth
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```

```
# A tibble: 1 x 4
  variable     n  mean    sd
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60  18.8  7.65
```

```
# A tibble: 2 x 6
  variable     n  mean    sd median   iqr
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 dose        60  1.17 0.629    1     1.5
2 len         60 18.8  7.65    19.2  12.2
```

```
    len supp dose
1   4.2   VC  0.5
2  11.5   VC  0.5
3   7.3   VC  0.5
4   5.8   VC  0.5
5   6.4   VC  0.5
6  10.0   VC  0.5
7  11.2   VC  0.5
8  11.2   VC  0.5
9   5.2   VC  0.5
10  7.0   VC  0.5
11 16.5   VC  1.0
12 16.5   VC  1.0
13 15.2   VC  1.0
14 17.3   VC  1.0
15 22.5   VC  1.0
16 17.3   VC  1.0
17 13.6   VC  1.0
18 14.5   VC  1.0
19 18.8   VC  1.0
20 15.5   VC  1.0
21 23.6   VC  2.0
22 18.5   VC  2.0
23 33.9   VC  2.0
24 25.5   VC  2.0
25 26.4   VC  2.0
26 32.5   VC  2.0
27 26.7   VC  2.0
28 21.5   VC  2.0
29 23.3   VC  2.0
30 29.5   VC  2.0
31 15.2   OJ  0.5
32 21.5   OJ  0.5
33 17.6   OJ  0.5
34  9.7   OJ  0.5
35 14.5   OJ  0.5
36 10.0   OJ  0.5
37  8.2   OJ  0.5
38  9.4   OJ  0.5
39 16.5   OJ  0.5
40  9.7   OJ  0.5
41 19.7   OJ  1.0
42 23.3   OJ  1.0
43 23.6   OJ  1.0
44 26.4   OJ  1.0
45 20.0   OJ  1.0
46 25.2   OJ  1.0
47 25.8   OJ  1.0
48 21.2   OJ  1.0
49 14.5   OJ  1.0
50 27.3   OJ  1.0
51 25.5   OJ  2.0
52 26.4   OJ  2.0
53 22.4   OJ  2.0
54 24.5   OJ  2.0
55 24.8   OJ  2.0
56 30.9   OJ  2.0
57 26.4   OJ  2.0
58 27.3   OJ  2.0
59 29.4   OJ  2.0
60 23.0   OJ  2.0
```
]

---
count: false
 

.panel1-rstatixtable-auto[

```r
library(rstatix)
data("ToothGrowth")
ToothGrowth %&gt;%
  get_summary_stats(len)
ToothGrowth %&gt;%
  get_summary_stats(len, type = "robust")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "five_number")
ToothGrowth %&gt;%
  get_summary_stats(len, type = "mean_sd")
ToothGrowth %&gt;%
  get_summary_stats(len,dose, show = c("mean","sd", "median","iqr"))

ToothGrowth %&gt;%
* freq_table(supp, dose)
```
]
 
.panel2-rstatixtable-auto[

```
# A tibble: 1 x 13
  variable     n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9   19.2  13.1  25.3  12.2  9.04  18.8  7.65 0.988
# … with 1 more variable: ci &lt;dbl&gt;
```

```
# A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   19.2  12.2
```

```
# A tibble: 1 x 7
  variable     n   min   max    q1 median    q3
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 len         60   4.2  33.9  13.1   19.2  25.3
```

```
# A tibble: 1 x 4
  variable     n  mean    sd
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 len         60  18.8  7.65
```

```
# A tibble: 2 x 6
  variable     n  mean    sd median   iqr
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 dose        60  1.17 0.629    1     1.5
2 len         60 18.8  7.65    19.2  12.2
```

```
# A tibble: 6 x 4
  supp   dose     n  prop
  &lt;fct&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 OJ      0.5    10  33.3
2 OJ      1      10  33.3
3 OJ      2      10  33.3
4 VC      0.5    10  33.3
5 VC      1      10  33.3
6 VC      2      10  33.3
```
]

&lt;style&gt;
.panel1-rstatixtable-auto {
  color: black;
  width: 58.8%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-rstatixtable-auto {
  color: black;
  width: 39.2%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-rstatixtable-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---

# [flextable](https://davidgohel.github.io/flextable/)


![funct](flextable_functions.png)


---

count: false
 

.panel1-flextable-auto[

```r
*library(rio)
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
*library(flextable)
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

*#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
*#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
*library(here)
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
*student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
*#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

*score_summary &lt;- student
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
* drop_na(w2chn, w2mat, w2eng)
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
* get_summary_stats(w2chn,
*                   w2mat, w2eng,
*                   type = "common")
```
]
 
.panel2-flextable-auto[

]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

*score_summary
```
]
 
.panel2-flextable-auto[

```
# A tibble: 3 x 10
  variable     n   min   max median   iqr  mean    sd    se    ci
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 w2chn     9863     0  142.     81    24  81.0  20.6 0.207 0.407
2 w2eng     9863     0  150      76    43  72.2  29.9 0.301 0.591
3 w2mat     9863     0  164      80    44  74.7  32.0 0.322 0.632
```
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
* flextable(col_keys = c(
*   "variable","n","min","max","mean","sd"))
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-55649130{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5564b3b8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5564b3cc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5564f418{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5564f436{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5564f44a{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5564f454{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5564f45e{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5564f468{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-5564f468"><p class="cl-5564b3b8"><span class="cl-55649130">variable</span></p></td><td class="cl-5564f45e"><p class="cl-5564b3cc"><span class="cl-55649130">n</span></p></td><td class="cl-5564f45e"><p class="cl-5564b3cc"><span class="cl-55649130">min</span></p></td><td class="cl-5564f45e"><p class="cl-5564b3cc"><span class="cl-55649130">max</span></p></td><td class="cl-5564f45e"><p class="cl-5564b3cc"><span class="cl-55649130">mean</span></p></td><td class="cl-5564f45e"><p class="cl-5564b3cc"><span class="cl-55649130">sd</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5564f436"><p class="cl-5564b3b8"><span class="cl-55649130">w2chn</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">9863</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">0</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">142.5</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">81.015</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">20.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5564f436"><p class="cl-5564b3b8"><span class="cl-55649130">w2eng</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">9863</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">0</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">150.0</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">72.204</span></p></td><td class="cl-5564f418"><p class="cl-5564b3cc"><span class="cl-55649130">29.931</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5564f454"><p class="cl-5564b3b8"><span class="cl-55649130">w2mat</span></p></td><td class="cl-5564f44a"><p class="cl-5564b3cc"><span class="cl-55649130">9863</span></p></td><td class="cl-5564f44a"><p class="cl-5564b3cc"><span class="cl-55649130">0</span></p></td><td class="cl-5564f44a"><p class="cl-5564b3cc"><span class="cl-55649130">164.0</span></p></td><td class="cl-5564f44a"><p class="cl-5564b3cc"><span class="cl-55649130">74.707</span></p></td><td class="cl-5564f44a"><p class="cl-5564b3cc"><span class="cl-55649130">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
* set_header_labels(variable="变量", n="数量",
*                   min="最小值",max="最大值",
*                   mean="均值",sd="标准差")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-55b4acc4{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-55b4c114{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-55b4c13c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-55b51542{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55b5156a{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55b51574{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55b5157e{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55b51588{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55b51592{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-55b51592"><p class="cl-55b4c114"><span class="cl-55b4acc4">变量</span></p></td><td class="cl-55b51588"><p class="cl-55b4c13c"><span class="cl-55b4acc4">数量</span></p></td><td class="cl-55b51588"><p class="cl-55b4c13c"><span class="cl-55b4acc4">最小值</span></p></td><td class="cl-55b51588"><p class="cl-55b4c13c"><span class="cl-55b4acc4">最大值</span></p></td><td class="cl-55b51588"><p class="cl-55b4c13c"><span class="cl-55b4acc4">均值</span></p></td><td class="cl-55b51588"><p class="cl-55b4c13c"><span class="cl-55b4acc4">标准差</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-55b5156a"><p class="cl-55b4c114"><span class="cl-55b4acc4">w2chn</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">9863</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">0</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">142.5</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">81.015</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">20.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-55b5156a"><p class="cl-55b4c114"><span class="cl-55b4acc4">w2eng</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">9863</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">0</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">150.0</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">72.204</span></p></td><td class="cl-55b51542"><p class="cl-55b4c13c"><span class="cl-55b4acc4">29.931</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-55b5157e"><p class="cl-55b4c114"><span class="cl-55b4acc4">w2mat</span></p></td><td class="cl-55b51574"><p class="cl-55b4c13c"><span class="cl-55b4acc4">9863</span></p></td><td class="cl-55b51574"><p class="cl-55b4c13c"><span class="cl-55b4acc4">0</span></p></td><td class="cl-55b51574"><p class="cl-55b4c13c"><span class="cl-55b4acc4">164.0</span></p></td><td class="cl-55b51574"><p class="cl-55b4c13c"><span class="cl-55b4acc4">74.707</span></p></td><td class="cl-55b51574"><p class="cl-55b4c13c"><span class="cl-55b4acc4">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
* bold(bold = T, part="header")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-55f7a2ea{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-55f7a312{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-55f7b5be{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-55f7b5dc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-55f83296{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55f832c8{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55f832dc{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55f832e6{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55f832fa{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55f83304{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-55f83304"><p class="cl-55f7b5be"><span class="cl-55f7a2ea">变量</span></p></td><td class="cl-55f832fa"><p class="cl-55f7b5dc"><span class="cl-55f7a2ea">数量</span></p></td><td class="cl-55f832fa"><p class="cl-55f7b5dc"><span class="cl-55f7a2ea">最小值</span></p></td><td class="cl-55f832fa"><p class="cl-55f7b5dc"><span class="cl-55f7a2ea">最大值</span></p></td><td class="cl-55f832fa"><p class="cl-55f7b5dc"><span class="cl-55f7a2ea">均值</span></p></td><td class="cl-55f832fa"><p class="cl-55f7b5dc"><span class="cl-55f7a2ea">标准差</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-55f832c8"><p class="cl-55f7b5be"><span class="cl-55f7a312">w2chn</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">9863</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">0</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">142.5</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">81.015</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">20.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-55f832c8"><p class="cl-55f7b5be"><span class="cl-55f7a312">w2eng</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">9863</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">0</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">150.0</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">72.204</span></p></td><td class="cl-55f83296"><p class="cl-55f7b5dc"><span class="cl-55f7a312">29.931</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-55f832e6"><p class="cl-55f7b5be"><span class="cl-55f7a312">w2mat</span></p></td><td class="cl-55f832dc"><p class="cl-55f7b5dc"><span class="cl-55f7a312">9863</span></p></td><td class="cl-55f832dc"><p class="cl-55f7b5dc"><span class="cl-55f7a312">0</span></p></td><td class="cl-55f832dc"><p class="cl-55f7b5dc"><span class="cl-55f7a312">164.0</span></p></td><td class="cl-55f832dc"><p class="cl-55f7b5dc"><span class="cl-55f7a312">74.707</span></p></td><td class="cl-55f832dc"><p class="cl-55f7b5dc"><span class="cl-55f7a312">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
* bg(bg="grey80",part = "header")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-563c8afe{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-563c8b30{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-563ca2dc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-563ca304{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-563d0f92{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-563d0fc4{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-563d0fce{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-563d0fd8{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-563d0fec{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-563d0fed{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-563d0fed"><p class="cl-563ca2dc"><span class="cl-563c8afe">变量</span></p></td><td class="cl-563d0fec"><p class="cl-563ca304"><span class="cl-563c8afe">数量</span></p></td><td class="cl-563d0fec"><p class="cl-563ca304"><span class="cl-563c8afe">最小值</span></p></td><td class="cl-563d0fec"><p class="cl-563ca304"><span class="cl-563c8afe">最大值</span></p></td><td class="cl-563d0fec"><p class="cl-563ca304"><span class="cl-563c8afe">均值</span></p></td><td class="cl-563d0fec"><p class="cl-563ca304"><span class="cl-563c8afe">标准差</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-563d0fc4"><p class="cl-563ca2dc"><span class="cl-563c8b30">w2chn</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">9863</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">0</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">142.5</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">81.015</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">20.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-563d0fc4"><p class="cl-563ca2dc"><span class="cl-563c8b30">w2eng</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">9863</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">0</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">150.0</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">72.204</span></p></td><td class="cl-563d0f92"><p class="cl-563ca304"><span class="cl-563c8b30">29.931</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-563d0fd8"><p class="cl-563ca2dc"><span class="cl-563c8b30">w2mat</span></p></td><td class="cl-563d0fce"><p class="cl-563ca304"><span class="cl-563c8b30">9863</span></p></td><td class="cl-563d0fce"><p class="cl-563ca304"><span class="cl-563c8b30">0</span></p></td><td class="cl-563d0fce"><p class="cl-563ca304"><span class="cl-563c8b30">164.0</span></p></td><td class="cl-563d0fce"><p class="cl-563ca304"><span class="cl-563c8b30">74.707</span></p></td><td class="cl-563d0fce"><p class="cl-563ca304"><span class="cl-563c8b30">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
* color(i=3, j=4,color = "red")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-56dc9f62{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-56dc9f8a{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-56dc9f94{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-56dcb42a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-56dcb448{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-56dcfc46{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56dcfc78{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56dcfc8c{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56dcfc96{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56dcfca0{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56dcfcaa{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-56dcfcaa"><p class="cl-56dcb42a"><span class="cl-56dc9f62">变量</span></p></td><td class="cl-56dcfca0"><p class="cl-56dcb448"><span class="cl-56dc9f62">数量</span></p></td><td class="cl-56dcfca0"><p class="cl-56dcb448"><span class="cl-56dc9f62">最小值</span></p></td><td class="cl-56dcfca0"><p class="cl-56dcb448"><span class="cl-56dc9f62">最大值</span></p></td><td class="cl-56dcfca0"><p class="cl-56dcb448"><span class="cl-56dc9f62">均值</span></p></td><td class="cl-56dcfca0"><p class="cl-56dcb448"><span class="cl-56dc9f62">标准差</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-56dcfc78"><p class="cl-56dcb42a"><span class="cl-56dc9f8a">w2chn</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">9863</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">0</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">142.5</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">81.015</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">20.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-56dcfc78"><p class="cl-56dcb42a"><span class="cl-56dc9f8a">w2eng</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">9863</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">0</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">150.0</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">72.204</span></p></td><td class="cl-56dcfc46"><p class="cl-56dcb448"><span class="cl-56dc9f8a">29.931</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-56dcfc96"><p class="cl-56dcb42a"><span class="cl-56dc9f8a">w2mat</span></p></td><td class="cl-56dcfc8c"><p class="cl-56dcb448"><span class="cl-56dc9f8a">9863</span></p></td><td class="cl-56dcfc8c"><p class="cl-56dcb448"><span class="cl-56dc9f8a">0</span></p></td><td class="cl-56dcfc8c"><p class="cl-56dcb448"><span class="cl-56dc9f94">164.0</span></p></td><td class="cl-56dcfc8c"><p class="cl-56dcb448"><span class="cl-56dc9f8a">74.707</span></p></td><td class="cl-56dcfc8c"><p class="cl-56dcb448"><span class="cl-56dc9f8a">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
  color(i=3, j=4,color = "red") %&gt;%
* width(j=3, width = 0.7)
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-5813e4b2{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5813e4da{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5813e4ee{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-5813f6aa{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5813f6c8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-58145dac{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145dde{width:50px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145de8{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145df2{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145dfc{width:50px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145e06{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145e10{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145e1a{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-58145e24{width:50px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-58145e1a"><p class="cl-5813f6aa"><span class="cl-5813e4b2">变量</span></p></td><td class="cl-58145e10"><p class="cl-5813f6c8"><span class="cl-5813e4b2">数量</span></p></td><td class="cl-58145e24"><p class="cl-5813f6c8"><span class="cl-5813e4b2">最小值</span></p></td><td class="cl-58145e10"><p class="cl-5813f6c8"><span class="cl-5813e4b2">最大值</span></p></td><td class="cl-58145e10"><p class="cl-5813f6c8"><span class="cl-5813e4b2">均值</span></p></td><td class="cl-58145e10"><p class="cl-5813f6c8"><span class="cl-5813e4b2">标准差</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-58145de8"><p class="cl-5813f6aa"><span class="cl-5813e4da">w2chn</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">9863</span></p></td><td class="cl-58145dde"><p class="cl-5813f6c8"><span class="cl-5813e4da">0</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">142.5</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">81.015</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">20.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-58145de8"><p class="cl-5813f6aa"><span class="cl-5813e4da">w2eng</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">9863</span></p></td><td class="cl-58145dde"><p class="cl-5813f6c8"><span class="cl-5813e4da">0</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">150.0</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">72.204</span></p></td><td class="cl-58145dac"><p class="cl-5813f6c8"><span class="cl-5813e4da">29.931</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-58145e06"><p class="cl-5813f6aa"><span class="cl-5813e4da">w2mat</span></p></td><td class="cl-58145df2"><p class="cl-5813f6c8"><span class="cl-5813e4da">9863</span></p></td><td class="cl-58145dfc"><p class="cl-5813f6c8"><span class="cl-5813e4da">0</span></p></td><td class="cl-58145df2"><p class="cl-5813f6c8"><span class="cl-5813e4ee">164.0</span></p></td><td class="cl-58145df2"><p class="cl-5813f6c8"><span class="cl-5813e4da">74.707</span></p></td><td class="cl-58145df2"><p class="cl-5813f6c8"><span class="cl-5813e4da">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
  color(i=3, j=4,color = "red") %&gt;%
  width(j=3, width = 0.7) %&gt;%
* hrule(rule = "exact")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-5874446a{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-587444f6{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5874450a{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-587481be{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-58748268{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5875c7b8{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c7e0{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c7f4{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c7fe{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c812{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c81c{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c826{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c83a{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5875c844{width:50px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-5875c83a"><p class="cl-587481be"><span class="cl-5874446a">变量</span></p></td><td class="cl-5875c826"><p class="cl-58748268"><span class="cl-5874446a">数量</span></p></td><td class="cl-5875c844"><p class="cl-58748268"><span class="cl-5874446a">最小值</span></p></td><td class="cl-5875c826"><p class="cl-58748268"><span class="cl-5874446a">最大值</span></p></td><td class="cl-5875c826"><p class="cl-58748268"><span class="cl-5874446a">均值</span></p></td><td class="cl-5875c826"><p class="cl-58748268"><span class="cl-5874446a">标准差</span></p></td></tr></thead><tbody><tr><td class="cl-5875c7f4"><p class="cl-587481be"><span class="cl-587444f6">w2chn</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">9863</span></p></td><td class="cl-5875c7e0"><p class="cl-58748268"><span class="cl-587444f6">0</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">142.5</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">81.015</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">20.600</span></p></td></tr><tr><td class="cl-5875c7f4"><p class="cl-587481be"><span class="cl-587444f6">w2eng</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">9863</span></p></td><td class="cl-5875c7e0"><p class="cl-58748268"><span class="cl-587444f6">0</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">150.0</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">72.204</span></p></td><td class="cl-5875c7b8"><p class="cl-58748268"><span class="cl-587444f6">29.931</span></p></td></tr><tr><td class="cl-5875c81c"><p class="cl-587481be"><span class="cl-587444f6">w2mat</span></p></td><td class="cl-5875c7fe"><p class="cl-58748268"><span class="cl-587444f6">9863</span></p></td><td class="cl-5875c812"><p class="cl-58748268"><span class="cl-587444f6">0</span></p></td><td class="cl-5875c7fe"><p class="cl-58748268"><span class="cl-5874450a">164.0</span></p></td><td class="cl-5875c7fe"><p class="cl-58748268"><span class="cl-587444f6">74.707</span></p></td><td class="cl-5875c7fe"><p class="cl-58748268"><span class="cl-587444f6">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
  color(i=3, j=4,color = "red") %&gt;%
  width(j=3, width = 0.7) %&gt;%
  hrule(rule = "exact") %&gt;%
* height(i=2, height = 0.4)
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-594c4752{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-594c4cfc{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-594c4d1a{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-594ca0ee{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-594ca116{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-594ce162{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce194{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce1a8{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce1bc{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce1d0{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce1da{width:50px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce1ee{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce202{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce20c{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce220{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce234{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-594ce23e{width:50px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-594ce234"><p class="cl-594ca0ee"><span class="cl-594c4752">变量</span></p></td><td class="cl-594ce220"><p class="cl-594ca116"><span class="cl-594c4752">数量</span></p></td><td class="cl-594ce23e"><p class="cl-594ca116"><span class="cl-594c4752">最小值</span></p></td><td class="cl-594ce220"><p class="cl-594ca116"><span class="cl-594c4752">最大值</span></p></td><td class="cl-594ce220"><p class="cl-594ca116"><span class="cl-594c4752">均值</span></p></td><td class="cl-594ce220"><p class="cl-594ca116"><span class="cl-594c4752">标准差</span></p></td></tr></thead><tbody><tr><td class="cl-594ce1a8"><p class="cl-594ca0ee"><span class="cl-594c4cfc">w2chn</span></p></td><td class="cl-594ce162"><p class="cl-594ca116"><span class="cl-594c4cfc">9863</span></p></td><td class="cl-594ce194"><p class="cl-594ca116"><span class="cl-594c4cfc">0</span></p></td><td class="cl-594ce162"><p class="cl-594ca116"><span class="cl-594c4cfc">142.5</span></p></td><td class="cl-594ce162"><p class="cl-594ca116"><span class="cl-594c4cfc">81.015</span></p></td><td class="cl-594ce162"><p class="cl-594ca116"><span class="cl-594c4cfc">20.600</span></p></td></tr><tr><td class="cl-594ce1d0"><p class="cl-594ca0ee"><span class="cl-594c4cfc">w2eng</span></p></td><td class="cl-594ce1bc"><p class="cl-594ca116"><span class="cl-594c4cfc">9863</span></p></td><td class="cl-594ce1da"><p class="cl-594ca116"><span class="cl-594c4cfc">0</span></p></td><td class="cl-594ce1bc"><p class="cl-594ca116"><span class="cl-594c4cfc">150.0</span></p></td><td class="cl-594ce1bc"><p class="cl-594ca116"><span class="cl-594c4cfc">72.204</span></p></td><td class="cl-594ce1bc"><p class="cl-594ca116"><span class="cl-594c4cfc">29.931</span></p></td></tr><tr><td class="cl-594ce20c"><p class="cl-594ca0ee"><span class="cl-594c4cfc">w2mat</span></p></td><td class="cl-594ce1ee"><p class="cl-594ca116"><span class="cl-594c4cfc">9863</span></p></td><td class="cl-594ce202"><p class="cl-594ca116"><span class="cl-594c4cfc">0</span></p></td><td class="cl-594ce1ee"><p class="cl-594ca116"><span class="cl-594c4d1a">164.0</span></p></td><td class="cl-594ce1ee"><p class="cl-594ca116"><span class="cl-594c4cfc">74.707</span></p></td><td class="cl-594ce1ee"><p class="cl-594ca116"><span class="cl-594c4cfc">32.001</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
  color(i=3, j=4,color = "red") %&gt;%
  width(j=3, width = 0.7) %&gt;%
  hrule(rule = "exact") %&gt;%
  height(i=2, height = 0.4) %&gt;%
* colformat_num(j=4:6, digits=1)
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-5a3d7078{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5a3d70aa{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5a3d70be{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-5a3d83ba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5a3d83d8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5a3db876{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db894{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8a8{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8a9{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8b2{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8bc{width:50px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8c6{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8d0{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8da{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8e4{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8e5{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3db8ee{width:50px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-5a3db8e5"><p class="cl-5a3d83ba"><span class="cl-5a3d7078">变量</span></p></td><td class="cl-5a3db8e4"><p class="cl-5a3d83d8"><span class="cl-5a3d7078">数量</span></p></td><td class="cl-5a3db8ee"><p class="cl-5a3d83d8"><span class="cl-5a3d7078">最小值</span></p></td><td class="cl-5a3db8e4"><p class="cl-5a3d83d8"><span class="cl-5a3d7078">最大值</span></p></td><td class="cl-5a3db8e4"><p class="cl-5a3d83d8"><span class="cl-5a3d7078">均值</span></p></td><td class="cl-5a3db8e4"><p class="cl-5a3d83d8"><span class="cl-5a3d7078">标准差</span></p></td></tr></thead><tbody><tr><td class="cl-5a3db8a8"><p class="cl-5a3d83ba"><span class="cl-5a3d70aa">w2chn</span></p></td><td class="cl-5a3db876"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">9863</span></p></td><td class="cl-5a3db894"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">0</span></p></td><td class="cl-5a3db876"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">142.5</span></p></td><td class="cl-5a3db876"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">81.0</span></p></td><td class="cl-5a3db876"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">20.6</span></p></td></tr><tr><td class="cl-5a3db8b2"><p class="cl-5a3d83ba"><span class="cl-5a3d70aa">w2eng</span></p></td><td class="cl-5a3db8a9"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">9863</span></p></td><td class="cl-5a3db8bc"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">0</span></p></td><td class="cl-5a3db8a9"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">150.0</span></p></td><td class="cl-5a3db8a9"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">72.2</span></p></td><td class="cl-5a3db8a9"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">29.9</span></p></td></tr><tr><td class="cl-5a3db8da"><p class="cl-5a3d83ba"><span class="cl-5a3d70aa">w2mat</span></p></td><td class="cl-5a3db8c6"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">9863</span></p></td><td class="cl-5a3db8d0"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">0</span></p></td><td class="cl-5a3db8c6"><p class="cl-5a3d83d8"><span class="cl-5a3d70be">164.0</span></p></td><td class="cl-5a3db8c6"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">74.7</span></p></td><td class="cl-5a3db8c6"><p class="cl-5a3d83d8"><span class="cl-5a3d70aa">32.0</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
  color(i=3, j=4,color = "red") %&gt;%
  width(j=3, width = 0.7) %&gt;%
  hrule(rule = "exact") %&gt;%
  height(i=2, height = 0.4) %&gt;%
  colformat_num(j=4:6, digits=1) %&gt;%
* set_caption(caption = "初中生期中语数外成绩统计表")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-5abcf3e8{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5abcf41a{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5abcf424{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-5abd06c6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5abd06e4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5ac153e8{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac154ba{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac154d8{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac154f6{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac1550a{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac1551e{width:50px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac1553c{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac15550{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac1556e{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac1558c{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac155a0{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ac155b4{width:50px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><caption>初中生期中语数外成绩统计表</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-5ac155a0"><p class="cl-5abd06c6"><span class="cl-5abcf3e8">变量</span></p></td><td class="cl-5ac1558c"><p class="cl-5abd06e4"><span class="cl-5abcf3e8">数量</span></p></td><td class="cl-5ac155b4"><p class="cl-5abd06e4"><span class="cl-5abcf3e8">最小值</span></p></td><td class="cl-5ac1558c"><p class="cl-5abd06e4"><span class="cl-5abcf3e8">最大值</span></p></td><td class="cl-5ac1558c"><p class="cl-5abd06e4"><span class="cl-5abcf3e8">均值</span></p></td><td class="cl-5ac1558c"><p class="cl-5abd06e4"><span class="cl-5abcf3e8">标准差</span></p></td></tr></thead><tbody><tr><td class="cl-5ac154d8"><p class="cl-5abd06c6"><span class="cl-5abcf41a">w2chn</span></p></td><td class="cl-5ac153e8"><p class="cl-5abd06e4"><span class="cl-5abcf41a">9863</span></p></td><td class="cl-5ac154ba"><p class="cl-5abd06e4"><span class="cl-5abcf41a">0</span></p></td><td class="cl-5ac153e8"><p class="cl-5abd06e4"><span class="cl-5abcf41a">142.5</span></p></td><td class="cl-5ac153e8"><p class="cl-5abd06e4"><span class="cl-5abcf41a">81.0</span></p></td><td class="cl-5ac153e8"><p class="cl-5abd06e4"><span class="cl-5abcf41a">20.6</span></p></td></tr><tr><td class="cl-5ac1550a"><p class="cl-5abd06c6"><span class="cl-5abcf41a">w2eng</span></p></td><td class="cl-5ac154f6"><p class="cl-5abd06e4"><span class="cl-5abcf41a">9863</span></p></td><td class="cl-5ac1551e"><p class="cl-5abd06e4"><span class="cl-5abcf41a">0</span></p></td><td class="cl-5ac154f6"><p class="cl-5abd06e4"><span class="cl-5abcf41a">150.0</span></p></td><td class="cl-5ac154f6"><p class="cl-5abd06e4"><span class="cl-5abcf41a">72.2</span></p></td><td class="cl-5ac154f6"><p class="cl-5abd06e4"><span class="cl-5abcf41a">29.9</span></p></td></tr><tr><td class="cl-5ac1556e"><p class="cl-5abd06c6"><span class="cl-5abcf41a">w2mat</span></p></td><td class="cl-5ac1553c"><p class="cl-5abd06e4"><span class="cl-5abcf41a">9863</span></p></td><td class="cl-5ac15550"><p class="cl-5abd06e4"><span class="cl-5abcf41a">0</span></p></td><td class="cl-5ac1553c"><p class="cl-5abd06e4"><span class="cl-5abcf424">164.0</span></p></td><td class="cl-5ac1553c"><p class="cl-5abd06e4"><span class="cl-5abcf41a">74.7</span></p></td><td class="cl-5ac1553c"><p class="cl-5abd06e4"><span class="cl-5abcf41a">32.0</span></p></td></tr></tbody></table></div>
]

---
count: false
 

.panel1-flextable-auto[

```r
library(rio)
library(flextable)

#student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown  #student &lt;- import("/sampledata/student_sample.dta") # does not work in R and R markdown
#student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file  #student &lt;- import("../sampledata/student_sample.dta") #work in R markdown not in R file
library(here)
student &lt;- import(here("sampledata","student_sample.dta"))  #work in R and R markdown file
#student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file  #student &lt;- import("/Users/yangyongye/R/pptgit/sampledata/student_sample.dta") # work in both R and R markdown file

score_summary &lt;- student %&gt;%
  drop_na(w2chn, w2mat, w2eng) %&gt;%
  get_summary_stats(w2chn,
                    w2mat, w2eng,
                    type = "common")

score_summary %&gt;%
  flextable(col_keys = c(
    "variable","n","min","max","mean","sd")) %&gt;%
  set_header_labels(variable="变量", n="数量",
                    min="最小值",max="最大值",
                    mean="均值",sd="标准差") %&gt;%
  bold(bold = T, part="header") %&gt;%
  bg(bg="grey80",part = "header") %&gt;%
  color(i=3, j=4,color = "red") %&gt;%
  width(j=3, width = 0.7) %&gt;%
  hrule(rule = "exact") %&gt;%
  height(i=2, height = 0.4) %&gt;%
  colformat_num(j=4:6, digits=1) %&gt;%
  set_caption(caption = "初中生期中语数外成绩统计表") %&gt;%
* footnote(i=1,j=2,
*          value=as_paragraph("包括七年级、九年级学生"),
*          ref_symbols = "a",
*          part="header")
```
]
 
.panel2-flextable-auto[
<div class="tabwid"><style>.cl-5b3faaea{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5b3fab26{font-family:'Arial';font-size:7px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;position: relative;bottom:3px;}.cl-5b3fab30{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-5b3fab3a{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-5b3fab4e{font-family:'Arial';font-size:6px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3px;}.cl-5b3fab58{font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5b3fcad4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5b3fcaf2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-5b3fcb06{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.00;background-color:transparent;}.cl-5b404d92{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404dc4{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404dce{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404dd8{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404de2{width:50px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404dec{width:54px;height:29px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404df6{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e00{width:54px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e0a{width:50px;height:18px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e14{width:54px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e15{width:50px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e1e{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e28{width:50px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b404e3c{width:54px;background-clip: padding-box;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><caption>初中生期中语数外成绩统计表</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-5b404e3c"><p class="cl-5b3fcad4"><span class="cl-5b3faaea">变量</span></p></td><td class="cl-5b404e1e"><p class="cl-5b3fcaf2"><span class="cl-5b3faaea">数量</span><span class="cl-5b3fab26">a</span></p></td><td class="cl-5b404e28"><p class="cl-5b3fcaf2"><span class="cl-5b3faaea">最小值</span></p></td><td class="cl-5b404e1e"><p class="cl-5b3fcaf2"><span class="cl-5b3faaea">最大值</span></p></td><td class="cl-5b404e1e"><p class="cl-5b3fcaf2"><span class="cl-5b3faaea">均值</span></p></td><td class="cl-5b404e1e"><p class="cl-5b3fcaf2"><span class="cl-5b3faaea">标准差</span></p></td></tr></thead><tbody><tr><td class="cl-5b404dce"><p class="cl-5b3fcad4"><span class="cl-5b3fab30">w2chn</span></p></td><td class="cl-5b404d92"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">9863</span></p></td><td class="cl-5b404dc4"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">0</span></p></td><td class="cl-5b404d92"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">142.5</span></p></td><td class="cl-5b404d92"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">81.0</span></p></td><td class="cl-5b404d92"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">20.6</span></p></td></tr><tr><td class="cl-5b404dec"><p class="cl-5b3fcad4"><span class="cl-5b3fab30">w2eng</span></p></td><td class="cl-5b404dd8"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">9863</span></p></td><td class="cl-5b404de2"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">0</span></p></td><td class="cl-5b404dd8"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">150.0</span></p></td><td class="cl-5b404dd8"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">72.2</span></p></td><td class="cl-5b404dd8"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">29.9</span></p></td></tr><tr><td class="cl-5b404e00"><p class="cl-5b3fcad4"><span class="cl-5b3fab30">w2mat</span></p></td><td class="cl-5b404df6"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">9863</span></p></td><td class="cl-5b404e0a"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">0</span></p></td><td class="cl-5b404df6"><p class="cl-5b3fcaf2"><span class="cl-5b3fab3a">164.0</span></p></td><td class="cl-5b404df6"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">74.7</span></p></td><td class="cl-5b404df6"><p class="cl-5b3fcaf2"><span class="cl-5b3fab30">32.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="6"class="cl-5b404e14"><p class="cl-5b3fcb06"><span class="cl-5b3fab4e">a</span><span class="cl-5b3fab58">包括七年级、九年级学生</span></p></td></tr></tbody></table></div>
]

&lt;style&gt;
.panel1-flextable-auto {
  color: black;
  width: 58.8%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-flextable-auto {
  color: black;
  width: 39.2%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-flextable-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;









---
# [gtsummary](http://www.danieldsjoberg.com/gtsummary/articles/tbl_summary.html)

--

- ## tbl_summary()

--

- ## tbl_cross()

---

count: false
 

.panel1-gtsummarytable-auto[

```r
*library(gtsummary)
```
]
 
.panel2-gtsummarytable-auto[

]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
*library(gt)
```
]
 
.panel2-gtsummarytable-auto[

]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
*library(dplyr)
```
]
 
.panel2-gtsummarytable-auto[

]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

*trial
```
]
 
.panel2-gtsummarytable-auto[

```
# A tibble: 200 x 8
   trt      age marker stage grade response death ttdeath
   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;
 1 Drug A    23  0.16  T1    II           0     0    24  
 2 Drug B     9  1.11  T2    I            1     0    24  
 3 Drug A    31  0.277 T1    II           0     0    24  
 4 Drug A    NA  2.07  T3    III          1     1    17.6
 5 Drug A    51  2.77  T4    III          1     1    16.4
 6 Drug B    39  0.613 T4    I            0     1    15.6
 7 Drug A    37  0.354 T1    II           0     0    24  
 8 Drug A    32  1.74  T1    I            0     1    18.4
 9 Drug A    31  0.144 T1    II           0     0    24  
10 Drug B    34  0.205 T3    I            0     1    10.5
# … with 190 more rows
```
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
* select(trt,age,grade)
```
]
 
.panel2-gtsummarytable-auto[

```
# A tibble: 200 x 3
   trt      age grade
   &lt;chr&gt;  &lt;dbl&gt; &lt;fct&gt;
 1 Drug A    23 II   
 2 Drug B     9 I    
 3 Drug A    31 II   
 4 Drug A    NA III  
 5 Drug A    51 III  
 6 Drug B    39 I    
 7 Drug A    37 II   
 8 Drug A    32 I    
 9 Drug A    31 II   
10 Drug B    34 I    
# … with 190 more rows
```
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
* tbl_summary(by = trt)
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#nhutlzszpa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nhutlzszpa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nhutlzszpa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nhutlzszpa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nhutlzszpa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nhutlzszpa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nhutlzszpa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nhutlzszpa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nhutlzszpa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nhutlzszpa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nhutlzszpa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nhutlzszpa .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#nhutlzszpa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nhutlzszpa .gt_from_md > :first-child {
  margin-top: 0;
}

#nhutlzszpa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nhutlzszpa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nhutlzszpa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#nhutlzszpa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nhutlzszpa .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#nhutlzszpa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nhutlzszpa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nhutlzszpa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nhutlzszpa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nhutlzszpa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nhutlzszpa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#nhutlzszpa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nhutlzszpa .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#nhutlzszpa .gt_left {
  text-align: left;
}

#nhutlzszpa .gt_center {
  text-align: center;
}

#nhutlzszpa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nhutlzszpa .gt_font_normal {
  font-weight: normal;
}

#nhutlzszpa .gt_font_bold {
  font-weight: bold;
}

#nhutlzszpa .gt_font_italic {
  font-style: italic;
}

#nhutlzszpa .gt_super {
  font-size: 65%;
}

#nhutlzszpa .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="nhutlzszpa" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="3">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Statistics presented: Median (IQR); n (%)
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
* add_p(pvalue_fun = ~style_pvalue(.x, digits = 2))
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jqqapdmsmo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jqqapdmsmo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqqapdmsmo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jqqapdmsmo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jqqapdmsmo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqqapdmsmo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqqapdmsmo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jqqapdmsmo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jqqapdmsmo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jqqapdmsmo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jqqapdmsmo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jqqapdmsmo .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jqqapdmsmo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jqqapdmsmo .gt_from_md > :first-child {
  margin-top: 0;
}

#jqqapdmsmo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jqqapdmsmo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jqqapdmsmo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#jqqapdmsmo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqqapdmsmo .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#jqqapdmsmo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqqapdmsmo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jqqapdmsmo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jqqapdmsmo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqqapdmsmo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqqapdmsmo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#jqqapdmsmo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqqapdmsmo .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#jqqapdmsmo .gt_left {
  text-align: left;
}

#jqqapdmsmo .gt_center {
  text-align: center;
}

#jqqapdmsmo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jqqapdmsmo .gt_font_normal {
  font-weight: normal;
}

#jqqapdmsmo .gt_font_bold {
  font-weight: bold;
}

#jqqapdmsmo .gt_font_italic {
  font-style: italic;
}

#jqqapdmsmo .gt_super {
  font-size: 65%;
}

#jqqapdmsmo .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="jqqapdmsmo" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="4">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Statistics presented: Median (IQR); n (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2)) %&gt;%
* add_overall()
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#iugqokgqpe .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iugqokgqpe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iugqokgqpe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iugqokgqpe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iugqokgqpe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iugqokgqpe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iugqokgqpe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iugqokgqpe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iugqokgqpe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iugqokgqpe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iugqokgqpe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iugqokgqpe .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#iugqokgqpe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iugqokgqpe .gt_from_md > :first-child {
  margin-top: 0;
}

#iugqokgqpe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iugqokgqpe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iugqokgqpe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#iugqokgqpe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iugqokgqpe .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#iugqokgqpe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iugqokgqpe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iugqokgqpe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iugqokgqpe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iugqokgqpe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iugqokgqpe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#iugqokgqpe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iugqokgqpe .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#iugqokgqpe .gt_left {
  text-align: left;
}

#iugqokgqpe .gt_center {
  text-align: center;
}

#iugqokgqpe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iugqokgqpe .gt_font_normal {
  font-weight: normal;
}

#iugqokgqpe .gt_font_bold {
  font-weight: bold;
}

#iugqokgqpe .gt_font_italic {
  font-style: italic;
}

#iugqokgqpe .gt_super {
  font-size: 65%;
}

#iugqokgqpe .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="iugqokgqpe" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Overall</strong>, N = 200<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">47 (38, 57)</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center">64 (32%)</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="5">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Statistics presented: Median (IQR); n (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2)) %&gt;%
  add_overall() %&gt;%
* add_n()
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vytybloiud .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vytybloiud .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vytybloiud .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vytybloiud .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vytybloiud .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vytybloiud .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vytybloiud .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vytybloiud .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vytybloiud .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vytybloiud .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vytybloiud .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vytybloiud .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vytybloiud .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vytybloiud .gt_from_md > :first-child {
  margin-top: 0;
}

#vytybloiud .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vytybloiud .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vytybloiud .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#vytybloiud .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vytybloiud .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#vytybloiud .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vytybloiud .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vytybloiud .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vytybloiud .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vytybloiud .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vytybloiud .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#vytybloiud .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vytybloiud .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#vytybloiud .gt_left {
  text-align: left;
}

#vytybloiud .gt_center {
  text-align: center;
}

#vytybloiud .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vytybloiud .gt_font_normal {
  font-weight: normal;
}

#vytybloiud .gt_font_bold {
  font-weight: bold;
}

#vytybloiud .gt_font_italic {
  font-style: italic;
}

#vytybloiud .gt_super {
  font-size: 65%;
}

#vytybloiud .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="vytybloiud" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Overall</strong>, N = 200<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">189</td>
      <td class="gt_row gt_center">47 (38, 57)</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center">200</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">64 (32%)</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="6">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Statistics presented: Median (IQR); n (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2)) %&gt;%
  add_overall() %&gt;%
  add_n() %&gt;%
* modify_header(label ~ "**Variable**")
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ceepgfphje .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ceepgfphje .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ceepgfphje .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ceepgfphje .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ceepgfphje .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceepgfphje .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ceepgfphje .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ceepgfphje .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ceepgfphje .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ceepgfphje .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ceepgfphje .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ceepgfphje .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ceepgfphje .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ceepgfphje .gt_from_md > :first-child {
  margin-top: 0;
}

#ceepgfphje .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ceepgfphje .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ceepgfphje .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ceepgfphje .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceepgfphje .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ceepgfphje .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceepgfphje .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ceepgfphje .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ceepgfphje .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceepgfphje .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ceepgfphje .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ceepgfphje .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ceepgfphje .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ceepgfphje .gt_left {
  text-align: left;
}

#ceepgfphje .gt_center {
  text-align: center;
}

#ceepgfphje .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ceepgfphje .gt_font_normal {
  font-weight: normal;
}

#ceepgfphje .gt_font_bold {
  font-weight: bold;
}

#ceepgfphje .gt_font_italic {
  font-style: italic;
}

#ceepgfphje .gt_super {
  font-size: 65%;
}

#ceepgfphje .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ceepgfphje" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Variable</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Overall</strong>, N = 200<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">189</td>
      <td class="gt_row gt_center">47 (38, 57)</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center">200</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">64 (32%)</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="6">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Statistics presented: Median (IQR); n (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2)) %&gt;%
  add_overall() %&gt;%
  add_n() %&gt;%
  modify_header(label ~ "**Variable**") %&gt;%
* modify_spanning_header(
*   c("stat_1","stat_2") ~ "**Treatment Received**")
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qvrfvhucgd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qvrfvhucgd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvrfvhucgd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qvrfvhucgd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qvrfvhucgd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvrfvhucgd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvrfvhucgd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qvrfvhucgd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qvrfvhucgd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qvrfvhucgd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qvrfvhucgd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qvrfvhucgd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qvrfvhucgd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qvrfvhucgd .gt_from_md > :first-child {
  margin-top: 0;
}

#qvrfvhucgd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qvrfvhucgd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qvrfvhucgd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qvrfvhucgd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvrfvhucgd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qvrfvhucgd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvrfvhucgd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qvrfvhucgd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qvrfvhucgd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvrfvhucgd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvrfvhucgd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qvrfvhucgd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvrfvhucgd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qvrfvhucgd .gt_left {
  text-align: left;
}

#qvrfvhucgd .gt_center {
  text-align: center;
}

#qvrfvhucgd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qvrfvhucgd .gt_font_normal {
  font-weight: normal;
}

#qvrfvhucgd .gt_font_bold {
  font-weight: bold;
}

#qvrfvhucgd .gt_font_italic {
  font-style: italic;
}

#qvrfvhucgd .gt_super {
  font-size: 65%;
}

#qvrfvhucgd .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="qvrfvhucgd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Variable</strong></th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Overall</strong>, N = 200<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner"><strong>Treatment Received</strong></span>
      </th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">189</td>
      <td class="gt_row gt_center">47 (38, 57)</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center">200</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">64 (32%)</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="6">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Statistics presented: Median (IQR); n (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2)) %&gt;%
  add_overall() %&gt;%
  add_n() %&gt;%
  modify_header(label ~ "**Variable**") %&gt;%
  modify_spanning_header(
    c("stat_1","stat_2") ~ "**Treatment Received**") %&gt;%
* modify_footnote(
*   starts_with("stat_") ~ "Median (IQR) or Frequency (%)"
* )
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#arkfgftzmz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#arkfgftzmz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#arkfgftzmz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#arkfgftzmz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#arkfgftzmz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arkfgftzmz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#arkfgftzmz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#arkfgftzmz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#arkfgftzmz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#arkfgftzmz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#arkfgftzmz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#arkfgftzmz .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#arkfgftzmz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#arkfgftzmz .gt_from_md > :first-child {
  margin-top: 0;
}

#arkfgftzmz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#arkfgftzmz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#arkfgftzmz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#arkfgftzmz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#arkfgftzmz .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#arkfgftzmz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#arkfgftzmz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#arkfgftzmz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#arkfgftzmz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arkfgftzmz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#arkfgftzmz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#arkfgftzmz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#arkfgftzmz .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#arkfgftzmz .gt_left {
  text-align: left;
}

#arkfgftzmz .gt_center {
  text-align: center;
}

#arkfgftzmz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#arkfgftzmz .gt_font_normal {
  font-weight: normal;
}

#arkfgftzmz .gt_font_bold {
  font-weight: bold;
}

#arkfgftzmz .gt_font_italic {
  font-style: italic;
}

#arkfgftzmz .gt_super {
  font-size: 65%;
}

#arkfgftzmz .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="arkfgftzmz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Variable</strong></th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Overall</strong>, N = 200<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner"><strong>Treatment Received</strong></span>
      </th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Age</td>
      <td class="gt_row gt_center">189</td>
      <td class="gt_row gt_center">47 (38, 57)</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Grade</td>
      <td class="gt_row gt_center">200</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">64 (32%)</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="6">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Median (IQR) or Frequency (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

---
count: false
 

.panel1-gtsummarytable-auto[

```r
library(gtsummary)
library(gt)
library(dplyr)

trial %&gt;%
  select(trt,age,grade) %&gt;%
  tbl_summary(by = trt) %&gt;%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2)) %&gt;%
  add_overall() %&gt;%
  add_n() %&gt;%
  modify_header(label ~ "**Variable**") %&gt;%
  modify_spanning_header(
    c("stat_1","stat_2") ~ "**Treatment Received**") %&gt;%
  modify_footnote(
    starts_with("stat_") ~ "Median (IQR) or Frequency (%)"
  ) %&gt;%
* bold_labels()
```
]
 
.panel2-gtsummarytable-auto[
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#mqyxnnlvmk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mqyxnnlvmk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mqyxnnlvmk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mqyxnnlvmk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mqyxnnlvmk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mqyxnnlvmk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mqyxnnlvmk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mqyxnnlvmk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mqyxnnlvmk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mqyxnnlvmk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mqyxnnlvmk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mqyxnnlvmk .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#mqyxnnlvmk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mqyxnnlvmk .gt_from_md > :first-child {
  margin-top: 0;
}

#mqyxnnlvmk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mqyxnnlvmk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mqyxnnlvmk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#mqyxnnlvmk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mqyxnnlvmk .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#mqyxnnlvmk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mqyxnnlvmk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mqyxnnlvmk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mqyxnnlvmk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mqyxnnlvmk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mqyxnnlvmk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#mqyxnnlvmk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mqyxnnlvmk .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#mqyxnnlvmk .gt_left {
  text-align: left;
}

#mqyxnnlvmk .gt_center {
  text-align: center;
}

#mqyxnnlvmk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mqyxnnlvmk .gt_font_normal {
  font-weight: normal;
}

#mqyxnnlvmk .gt_font_bold {
  font-weight: bold;
}

#mqyxnnlvmk .gt_font_italic {
  font-style: italic;
}

#mqyxnnlvmk .gt_super {
  font-size: 65%;
}

#mqyxnnlvmk .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="mqyxnnlvmk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Variable</strong></th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Overall</strong>, N = 200<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner"><strong>Treatment Received</strong></span>
      </th>
      <th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>p-value</strong><sup class="gt_footnote_marks">2</sup></th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug A</strong>, N = 98<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Drug B</strong>, N = 102<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left" style="font-weight: bold;">Age</td>
      <td class="gt_row gt_center">189</td>
      <td class="gt_row gt_center">47 (38, 57)</td>
      <td class="gt_row gt_center">46 (37, 59)</td>
      <td class="gt_row gt_center">48 (39, 56)</td>
      <td class="gt_row gt_center">0.72</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Unknown</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="font-weight: bold;">Grade</td>
      <td class="gt_row gt_center">200</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">I</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">35 (36%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">II</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">68 (34%)</td>
      <td class="gt_row gt_center">32 (33%)</td>
      <td class="gt_row gt_center">36 (35%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">III</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">64 (32%)</td>
      <td class="gt_row gt_center">31 (32%)</td>
      <td class="gt_row gt_center">33 (32%)</td>
      <td class="gt_row gt_center"></td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="6">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          Median (IQR) or Frequency (%)
          <br />
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          Statistical tests performed: Wilcoxon rank-sum test; chi-square test of independence
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
]

&lt;style&gt;
.panel1-gtsummarytable-auto {
  color: black;
  width: 49%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-gtsummarytable-auto {
  color: black;
  width: 49%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-gtsummarytable-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---

# [DT](https://rstudio.github.io/DT/)


```r
library(DT)
mtcars %&gt;% 
  select(mpg, cyl, disp, hp, drat, wt) %&gt;% datatable()
```

<div id="htmlwidget-441a6ba1ca32d9e11d83" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-441a6ba1ca32d9e11d83">{"x":{"filter":"none","data":[["Mazda RX4","Mazda RX4 Wag","Datsun 710","Hornet 4 Drive","Hornet Sportabout","Valiant","Duster 360","Merc 240D","Merc 230","Merc 280","Merc 280C","Merc 450SE","Merc 450SL","Merc 450SLC","Cadillac Fleetwood","Lincoln Continental","Chrysler Imperial","Fiat 128","Honda Civic","Toyota Corolla","Toyota Corona","Dodge Challenger","AMC Javelin","Camaro Z28","Pontiac Firebird","Fiat X1-9","Porsche 914-2","Lotus Europa","Ford Pantera L","Ferrari Dino","Maserati Bora","Volvo 142E"],[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],[6,6,4,6,8,6,8,4,4,6,6,8,8,8,8,8,8,4,4,4,4,8,8,8,8,4,4,4,8,6,8,4],[160,160,108,258,360,225,360,146.7,140.8,167.6,167.6,275.8,275.8,275.8,472,460,440,78.7,75.7,71.1,120.1,318,304,350,400,79,120.3,95.1,351,145,301,121],[110,110,93,110,175,105,245,62,95,123,123,180,180,180,205,215,230,66,52,65,97,150,150,245,175,66,91,113,264,175,335,109],[3.9,3.9,3.85,3.08,3.15,2.76,3.21,3.69,3.92,3.92,3.92,3.07,3.07,3.07,2.93,3,3.23,4.08,4.93,4.22,3.7,2.76,3.15,3.73,3.08,4.08,4.43,3.77,4.22,3.62,3.54,4.11],[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mpg<\/th>\n      <th>cyl<\/th>\n      <th>disp<\/th>\n      <th>hp<\/th>\n      <th>drat<\/th>\n      <th>wt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---
# Practice 

- 做一个频数表，性别，户口，家庭经济条件

- 做一个交叉表，恋爱与否与家庭经济条件

- 做一个统计表，身高，体重

---
class: inverse

# NEXT WEEK

- ## R Graphics Cookbook, [Chapter 2-8](https://r-graphics.org) (required)

- ## An Introduction R [Chapter 4](https://intro2r.com/graphics-base-r.html) (optional)

- ## ggplot2:  Elegant Graphics for Data Analysis [Chapter 1-11](https://ggplot2-book.org/) (optional)

- ## R4DS [Chapter 17-21](https://r4ds.had.co.nz/program-intro.html) (optional)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
